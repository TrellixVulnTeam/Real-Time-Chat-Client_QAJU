{"ast":null,"code":"import _regeneratorRuntime from\"/home/bzeeno/Code/Go/RealTimeChat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/bzeeno/Code/Go/RealTimeChat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/bzeeno/Code/Go/RealTimeChat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useHistory}from'react-router-dom';import Button from'@mui/material/Button';import Menu from'@mui/material/Menu';import{MenuItem}from'@mui/material';//import FormControl from '@mui/material/FormControl';\n//import InputLabel from '@mui/material/InputLabel';\nimport'../pages/Home.scss';import'./Preview.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SIZES=['img-large','img-small'];export var Preview=function Preview(props){var getImgSize=SIZES.includes(props.size)?props.size:SIZES[0];// get button style. default to primary\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),isFriend=_useState2[0],setIsFriend=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),previewPic=_useState4[0],setPreviewPic=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),previewName=_useState6[0],setPreviewName=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),friends=_useState8[0],setFriends=_useState8[1];var _React$useState=React.useState(null),_React$useState2=_slicedToArray(_React$useState,2),anchorEl=_React$useState2[0],setAnchorEl=_React$useState2[1];var open=Boolean(anchorEl);var handleClick=function handleClick(event){setAnchorEl(event.currentTarget);};var handleClose=function handleClose(){setAnchorEl(null);};var history=useHistory();// when friend is clicked function\nuseEffect(function(){var isMounted=true;var getFriends=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(\"http://\".concat(process.env.REACT_APP_SERVER_URL,\"/api/get-friends\"),{headers:{'Content-Type':'application/json'},credentials:'include'});case 2:response=_context.sent;_context.next=5;return response.json();case 5:result=_context.sent;if(isMounted){setFriends(result['friends']);}case 7:case\"end\":return _context.stop();}}},_callee);}));return function getFriends(){return _ref.apply(this,arguments);};}();var checkFriend=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"http://\".concat(process.env.REACT_APP_SERVER_URL,\"/api/check-friend\"),{// send post request to logout endpoint\nmethod:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({friend_id:props.friend_id})});case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:result=_context2.sent;if(isMounted){if(result['message']==='true'){setIsFriend(true);}else{setIsFriend(false);}}case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function checkFriend(){return _ref2.apply(this,arguments);};}();var getFriendInfo=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response,result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"http://\".concat(process.env.REACT_APP_SERVER_URL,\"/api/get-friend-info\"),{// send post request to logout endpoint\nmethod:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({friend_id:props.friend_id})});case 2:response=_context3.sent;_context3.next=5;return response.json();case 5:result=_context3.sent;if(result['message']==='Could Not Find User'){console.log(result);}else{if(isMounted){setPreviewName(result['username']);setPreviewPic(result['profile_pic']);}}case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function getFriendInfo(){return _ref3.apply(this,arguments);};}();var getRoomInfo=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response,result;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return fetch(\"http://\".concat(process.env.REACT_APP_SERVER_URL,\"/api/get-room-info\"),{// send post request to logout endpoint\nmethod:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({room_id:props.room_id})});case 2:response=_context4.sent;_context4.next=5;return response.json();case 5:result=_context4.sent;if(result['message']==='Could Not Find Room'){console.log(result);}else{if(isMounted){setPreviewName(result['room_name']);setPreviewPic(result['room_pic']);}}case 7:case\"end\":return _context4.stop();}}},_callee4);}));return function getRoomInfo(){return _ref4.apply(this,arguments);};}();if(isMounted){if(props.isRoom===true){getRoomInfo().catch(setPreviewName(''),setPreviewPic('default_room.jpeg'));getFriends().catch(setFriends(''));}else{checkFriend().catch(setIsFriend(false));getFriendInfo().catch(setPreviewName(''),setPreviewPic('default.jpeg'));}}return function(){isMounted=false;};},[props.friend_id,props.room_id,props.isRoom]);var addFriend=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var response,result;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return fetch(\"http://\".concat(process.env.REACT_APP_SERVER_URL,\"/api/add-friend\"),{// send post request to logout endpoint\nmethod:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({friend_id:props.friend_id})});case 2:response=_context5.sent;_context5.next=5;return response.json();case 5:result=_context5.sent;props.setReq({\"sender_id\":props.user['_id'],\"friend_id\":props.friend_id,\"req\":\"add-friend\",\"in_pending\":props.inPending.toString()});//window.location.reload()\ncase 7:case\"end\":return _context5.stop();}}},_callee5);}));return function addFriend(){return _ref5.apply(this,arguments);};}();var removeFriend=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var response,result;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return fetch(\"http://\".concat(process.env.REACT_APP_SERVER_URL,\"/api/remove-friend\"),{// send post request to logout endpoint\nmethod:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({friend_id:props.friend_id})});case 2:response=_context6.sent;_context6.next=5;return response.json();case 5:result=_context6.sent;console.log(result);props.setReq({\"sender_id\":props.user['_id'],\"friend_id\":props.friend_id,\"req\":\"remove-friend\"});//history.push('/')\n//window.location.reload();\ncase 8:case\"end\":return _context6.stop();}}},_callee6);}));return function removeFriend(){return _ref6.apply(this,arguments);};}();var goToMessages=function goToMessages(){history.push('/friend/'+props.friend_id);};var leaveRoom=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var response;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return fetch(\"http://\".concat(process.env.REACT_APP_SERVER_URL,\"/api/leave-room\"),{// send post request to logout endpoint\nmethod:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({room_id:props.room_id})});case 2:response=_context7.sent;window.location.reload();return _context7.abrupt(\"return\",response);case 5:case\"end\":return _context7.stop();}}},_callee7);}));return function leaveRoom(){return _ref7.apply(this,arguments);};}();var goToChat=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:history.push('/room/'+props.room_id);case 1:case\"end\":return _context8.stop();}}},_callee8);}));return function goToChat(){return _ref8.apply(this,arguments);};}();var sendRoomInvite=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(event){var response,result;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:console.log('event target: ',event.target);console.log('event target value: ',event.target.id);_context9.next=4;return fetch(\"http://\".concat(process.env.REACT_APP_SERVER_URL,\"/api/add-to-room\"),{// send post request to logout endpoint\nmethod:'POST',headers:{'Content-Type':'application/json'},credentials:'include',body:JSON.stringify({friend_id:event.target.id,room_id:props.room_id})});case 4:response=_context9.sent;_context9.next=7;return response.json();case 7:result=_context9.sent;console.log(result);if(result[\"message\"]!==\"Friend is already in room\"){props.setReq({\"sender_id\":props.user['_id'],\"friend_id\":event.target.id,\"room_id\":props.room_id,\"req\":\"add-to-room\"});}//window.location.reload()\ncase 10:case\"end\":return _context9.stop();}}},_callee9);}));return function sendRoomInvite(_x){return _ref9.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"friend-container mt-2\",id:props.id,children:[/*#__PURE__*/_jsx(\"img\",{src:'../'+previewPic,alt:\"friend\",className:\"\".concat(getImgSize),id:props.id}),props.overlay?!props.isRoom?// if preview for friend:\ngetImgSize==='img-large'?/*#__PURE__*/ // if image is large:\n_jsx(\"div\",{className:\"overlay \".concat(getImgSize),children:/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[isFriend===false?/*#__PURE__*/ // if they are not friends:\n_jsx(Button,{style:{margin:'0 auto',display:\"flex\"},className:\"overlay-btn mt-4\",variant:\"contained\",color:\"secondary\",size:\"small\",onClick:addFriend,children:\"Add Friend\"}):/*#__PURE__*/ // if they are friends:\n_jsx(Button,{style:{margin:'0 auto',display:\"flex\"},className:\"overlay-btn mt-4\",variant:\"contained\",color:\"secondary\",size:\"small\",onClick:goToMessages,children:\"Message\"}),isFriend===true?/*#__PURE__*/_jsx(Button,{style:{margin:'0 auto',display:\"flex\"},className:\"overlay-btn mt-4\",variant:\"contained\",color:\"error\",size:\"small\",onClick:removeFriend,children:\"Remove Friend\"}):null]})}):null// if small-image\n:/*#__PURE__*/ // if preview for Room: }\n_jsx(\"div\",{className:\"overlay \".concat(getImgSize),children:/*#__PURE__*/_jsxs(\"div\",{className:\"col\",children:[/*#__PURE__*/_jsx(Button,{style:{margin:'0 auto',display:\"flex\"},className:\"overlay-btn mt-3\",variant:\"contained\",color:\"secondary\",size:\"small\",onClick:goToChat,children:\"Chat\"}),/*#__PURE__*/_jsx(Button,{style:{margin:'0 auto',display:\"flex\"},variant:\"contained\",color:\"secondary\",className:\"overlay-btn mt-2\",id:\"basic-button\",\"aria-controls\":\"basic-menu\",\"aria-haspopup\":\"true\",\"aria-expanded\":open?'true':undefined,onClick:handleClick,children:\"Invite Friend\"}),/*#__PURE__*/_jsx(Menu,{id:\"basic-menu\",anchorEl:anchorEl,open:open,onClose:handleClose,MenuListProps:{'aria-labelledby':'basic-button'},children:Object.keys(friends).map(function(key){return/*#__PURE__*/_jsx(MenuItem,{sx:{backgroundColor:'#242424','&:hover':{backgroundColor:'#2d2d2d'}},onClick:function onClick(e){return sendRoomInvite(e);},children:/*#__PURE__*/_jsx(Preview,{alt:\"friend\",size:\"img-small\",isRoom:false,friend_id:friends[key],id:friends[key]})},key);})}),/*#__PURE__*/_jsx(Button,{style:{margin:'0 auto',display:\"flex\"},variant:\"contained\",color:\"error\",className:\"overlay-btn mt-2\",onClick:leaveRoom,children:\"Leave Room\"})]})}):null,\" \"]}),/*#__PURE__*/_jsx(\"div\",{className:\"friend-name\",children:/*#__PURE__*/_jsx(\"p\",{children:previewName})})]});};","map":{"version":3,"sources":["/home/bzeeno/Code/Go/RealTimeChat/frontend/src/components/Preview.js"],"names":["React","useState","useEffect","useHistory","Button","Menu","MenuItem","SIZES","Preview","props","getImgSize","includes","size","isFriend","setIsFriend","previewPic","setPreviewPic","previewName","setPreviewName","friends","setFriends","anchorEl","setAnchorEl","open","Boolean","handleClick","event","currentTarget","handleClose","history","isMounted","getFriends","fetch","process","env","REACT_APP_SERVER_URL","headers","credentials","response","json","result","checkFriend","method","body","JSON","stringify","friend_id","getFriendInfo","console","log","getRoomInfo","room_id","isRoom","catch","addFriend","setReq","user","inPending","toString","removeFriend","goToMessages","push","leaveRoom","window","location","reload","goToChat","sendRoomInvite","target","id","overlay","margin","display","undefined","Object","keys","map","key","backgroundColor","e"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport {useHistory} from 'react-router-dom'\nimport Button from '@mui/material/Button';\nimport Menu from '@mui/material/Menu';\nimport { MenuItem } from '@mui/material';\n\n//import FormControl from '@mui/material/FormControl';\n//import InputLabel from '@mui/material/InputLabel';\n\nimport '../pages/Home.scss'\nimport './Preview.scss'\n\nconst SIZES = ['img-large','img-small']\n\nexport const Preview = (props) => {\n    const getImgSize = SIZES.includes(props.size) ? props.size : SIZES[0]; // get button style. default to primary\n    const [isFriend, setIsFriend] = useState(false)\n    const [previewPic, setPreviewPic] = useState('')\n    const [previewName, setPreviewName] = useState('')\n    const [friends, setFriends] = useState(false)\n\n    const [anchorEl, setAnchorEl] = React.useState(null);\n    const open = Boolean(anchorEl);\n    const handleClick = (event) => {\n        setAnchorEl(event.currentTarget);\n    };\n    const handleClose = () => {\n        setAnchorEl(null);\n    };\n\n    const history = useHistory()\n\n    // when friend is clicked function\n    useEffect(() => {\n        let isMounted = true\n        const getFriends = async() => {\n            const response = await fetch(`http://${process.env.REACT_APP_SERVER_URL}/api/get-friends`, {\n                headers: {'Content-Type': 'application/json'},\n                credentials: 'include'\n            })\n\n            const result = await response.json()\n            if (isMounted) {\n                setFriends(result['friends']) \n            }\n        }\n\n        const checkFriend = async () => {\n            const response = await fetch(`http://${process.env.REACT_APP_SERVER_URL}/api/check-friend`, { // send post request to logout endpoint\n                method: 'POST',\n                headers: {'Content-Type': 'application/json'},\n                credentials: 'include',\n                body: JSON.stringify({\n                    friend_id: props.friend_id\n                })\n            })\n\n            const result = await response.json()\n\n            if (isMounted) {\n                if (result['message'] === 'true') {\n                    setIsFriend(true)\n                } else {\n                    setIsFriend(false)\n                }\n            }\n        }\n        const getFriendInfo = async () => {\n            const response = await fetch(`http://${process.env.REACT_APP_SERVER_URL}/api/get-friend-info`, { // send post request to logout endpoint\n                method: 'POST',\n                headers: {'Content-Type': 'application/json'},\n                credentials: 'include',\n                body: JSON.stringify({\n                    friend_id: props.friend_id\n                })\n            })\n\n            const result = await response.json()\n\n            if (result['message'] === 'Could Not Find User') {\n                console.log(result)\n            } else {\n                if (isMounted) {\n                    setPreviewName(result['username'])\n                    setPreviewPic(result['profile_pic'])\n                }\n            }\n        }\n        const getRoomInfo = async () => {\n            const response = await fetch(`http://${process.env.REACT_APP_SERVER_URL}/api/get-room-info`, { // send post request to logout endpoint\n                method: 'POST',\n                headers: {'Content-Type': 'application/json'},\n                credentials: 'include',\n                body: JSON.stringify({\n                    room_id: props.room_id\n                })\n            })\n\n            const result = await response.json()\n\n            if (result['message'] === 'Could Not Find Room') {\n                console.log(result)\n            } else {\n                if (isMounted) {\n                    setPreviewName(result['room_name'])\n                    setPreviewPic(result['room_pic'])\n                }\n            }\n        }\n\n        if (isMounted) {\n            if (props.isRoom === true) {\n                getRoomInfo().catch(setPreviewName(''), setPreviewPic('default_room.jpeg'))\n                getFriends().catch(setFriends(''))\n            } else {\n                checkFriend().catch(setIsFriend(false))\n                getFriendInfo().catch(setPreviewName(''), setPreviewPic('default.jpeg'))\n            }\n        }\n\n        return () => { isMounted=false }\n\n    }, [props.friend_id, props.room_id, props.isRoom])\n\n    const addFriend = async() => {\n        const response = await fetch(`http://${process.env.REACT_APP_SERVER_URL}/api/add-friend`, { // send post request to logout endpoint\n            method: 'POST',\n            headers: {'Content-Type': 'application/json'},\n            credentials: 'include',\n            body: JSON.stringify({\n                friend_id: props.friend_id\n            })\n        })\n\n        const result = await response.json();\n        props.setReq({\"sender_id\": props.user['_id'], \"friend_id\": props.friend_id, \"req\": \"add-friend\", \"in_pending\":props.inPending.toString()})\n\n        //window.location.reload()\n    }\n\n    const removeFriend = async() => {\n        const response = await fetch(`http://${process.env.REACT_APP_SERVER_URL}/api/remove-friend`, { // send post request to logout endpoint\n            method: 'POST',\n            headers: {'Content-Type': 'application/json'},\n            credentials: 'include',\n            body: JSON.stringify({\n                friend_id: props.friend_id\n            })\n        })\n\n        const result = await response.json()\n        console.log(result);\n        props.setReq({\"sender_id\": props.user['_id'], \"friend_id\": props.friend_id, \"req\": \"remove-friend\"})\n\n        //history.push('/')\n        //window.location.reload();\n    }\n\n\n    const goToMessages = () => {\n        history.push('/friend/' + props.friend_id)\n    }\n\n    const leaveRoom = async() => {\n        const response = await fetch(`http://${process.env.REACT_APP_SERVER_URL}/api/leave-room`, { // send post request to logout endpoint\n            method: 'POST',\n            headers: {'Content-Type': 'application/json'},\n            credentials: 'include',\n            body: JSON.stringify({\n                room_id: props.room_id\n            })\n        })\n        window.location.reload();\n        return response\n    }\n\n    const goToChat = async() => {\n        history.push('/room/' + props.room_id)\n    }\n\n    const sendRoomInvite = async(event) => {\n        console.log('event target: ', event.target)\n        console.log('event target value: ', event.target.id)\n        const response = await fetch(`http://${process.env.REACT_APP_SERVER_URL}/api/add-to-room`, { // send post request to logout endpoint\n            method: 'POST',\n            headers: {'Content-Type': 'application/json'},\n            credentials: 'include',\n            body: JSON.stringify({\n                friend_id: event.target.id,\n                room_id: props.room_id\n            })\n        })\n\n        const result = await response.json();\n        console.log(result)\n        if (result[\"message\"] !== \"Friend is already in room\") {\n            props.setReq({\"sender_id\": props.user['_id'], \"friend_id\": event.target.id, \"room_id\": props.room_id, \"req\": \"add-to-room\"})\n        }\n        //window.location.reload()\n    }\n\n\n    return (\n        <div>\n            <div className='friend-container mt-2' id={props.id}>\n                <img src={'../'+previewPic} alt='friend' className={`${getImgSize}`} id={props.id} />\n                { props.overlay ?\n                    !props.isRoom ? // if preview for friend:\n                        getImgSize === 'img-large' ? // if image is large:\n                        <div className={`overlay ${getImgSize}`}>  \n                        <div className='col'>\n                            {isFriend === false ? // if they are not friends:\n                                    <Button style={{margin: '0 auto', display: \"flex\"}} className='overlay-btn mt-4' variant='contained' color='secondary' size='small' onClick={addFriend}>Add Friend</Button>\n                                :   // if they are friends:\n                                    <Button style={{margin: '0 auto', display: \"flex\"}} className='overlay-btn mt-4' variant='contained' color='secondary' size='small' onClick={goToMessages}>Message</Button>\n                            }\n                            {isFriend === true ?\n                                    <Button style={{margin: '0 auto', display: \"flex\"}} className='overlay-btn mt-4' variant='contained' color='error' size='small' onClick={removeFriend}>Remove Friend</Button>\n                                : null}\n                        </div>\n                        </div>\n                        : null // if small-image\n            : // if preview for Room: }\n                <div className={`overlay ${getImgSize}`}>  \n                    <div className='col'>\n                            <Button style={{margin: '0 auto', display: \"flex\"}} className='overlay-btn mt-3' variant='contained' color='secondary' size='small' onClick={goToChat}>Chat</Button>\n                            <Button\n                                style={{margin: '0 auto', display: \"flex\"}}\n                                variant='contained'\n                                color='secondary'\n                                className='overlay-btn mt-2'\n                                id=\"basic-button\"\n                                aria-controls=\"basic-menu\"\n                                aria-haspopup=\"true\"\n                                aria-expanded={open ? 'true' : undefined}\n                                onClick={handleClick}\n                            >\n                            Invite Friend\n                            </Button>\n                            <Menu\n                                id=\"basic-menu\"\n                                anchorEl={anchorEl}\n                                open={open}\n                                onClose={handleClose}\n                                MenuListProps={{'aria-labelledby': 'basic-button',}}\n                                \n                            >\n                                {Object.keys(friends).map(key => \n                                    <MenuItem key={key} sx={{backgroundColor: '#242424', '&:hover': {backgroundColor: '#2d2d2d'}}} onClick={(e) => sendRoomInvite(e)}  >\n                                        <Preview alt='friend' size='img-small' isRoom={false} friend_id={friends[key]} id={friends[key]} />\n                                    </MenuItem>\n                                )}\n\n                            </Menu>\n                            <Button style={{margin: '0 auto', display: \"flex\"}} variant='contained' color='error' className='overlay-btn mt-2' onClick={leaveRoom}>Leave Room</Button>\n                    </div>\n                </div> : null } {/* if no overlay, set to null */}\n\n        </div>\n\n            <div className='friend-name'>\n                <p>{previewName}</p>\n            </div>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}