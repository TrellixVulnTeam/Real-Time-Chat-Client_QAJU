(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{100:function(e,t,n){},101:function(e,t,n){},102:function(e,t,n){},103:function(e,t,n){},104:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),s=n(15),a=n.n(s),o=(n(86),n(8)),i=n.n(o),u=n(10),l=n(6),d=(n(88),n(14)),j=n(25),m=n(164),f=n(160),b=n(162),p=(n(64),n(89),n(2)),h=["img-large","img-small"],O=function e(t){var n=h.includes(t.size)?t.size:h[0],s=Object(r.useState)(!1),a=Object(l.a)(s,2),o=a[0],j=a[1],O=Object(r.useState)(""),x=Object(l.a)(O,2),v=x[0],g=x[1],y=Object(r.useState)(""),N=Object(l.a)(y,2),S=N[0],w=N[1],_=Object(r.useState)(!1),C=Object(l.a)(_,2),k=C[0],R=C[1],T=c.a.useState(null),P=Object(l.a)(T,2),q=P[0],I=P[1],J=Boolean(q),z=Object(d.f)();Object(r.useEffect)((function(){var e=!0,n=function(){var t=Object(u.a)(i.a.mark((function t(){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://".concat("rtc-server.one","/api/get-friends"),{headers:{"Content-Type":"application/json"},credentials:"include"});case 2:return n=t.sent,t.next=5,n.json();case 5:r=t.sent,e&&R(r.friends);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r=function(){var n=Object(u.a)(i.a.mark((function n(){var r,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://".concat("rtc-server.one","/api/check-friend"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({friend_id:t.friend_id})});case 2:return r=n.sent,n.next=5,r.json();case 5:c=n.sent,e&&("true"===c.message?j(!0):j(!1));case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),c=function(){var n=Object(u.a)(i.a.mark((function n(){var r,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://".concat("rtc-server.one","/api/get-friend-info"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({friend_id:t.friend_id})});case 2:return r=n.sent,n.next=5,r.json();case 5:"Could Not Find User"===(c=n.sent).message?console.log(c):e&&(w(c.username),g(c.profile_pic));case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),s=function(){var n=Object(u.a)(i.a.mark((function n(){var r,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://".concat("rtc-server.one","/api/get-room-info"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({room_id:t.room_id})});case 2:return r=n.sent,n.next=5,r.json();case 5:"Could Not Find Room"===(c=n.sent).message?console.log(c):e&&(w(c.room_name),g(c.room_pic));case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return e&&(!0===t.isRoom?(s().catch(w(""),g("default_room.jpeg")),n().catch(R(""))):(r().catch(j(!1)),c().catch(w(""),g("default.jpeg")))),function(){e=!1}}),[t.friend_id,t.room_id,t.isRoom]);var F=function(){var e=Object(u.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/add-friend"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({friend_id:t.friend_id})});case 2:return n=e.sent,e.next=5,n.json();case 5:e.sent,t.setReq({sender_id:t.user._id,friend_id:t.friend_id,req:"add-friend",in_pending:t.inPending.toString()});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){var e=Object(u.a)(i.a.mark((function e(){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/remove-friend"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({friend_id:t.friend_id})});case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,console.log(r),t.setReq({sender_id:t.user._id,friend_id:t.friend_id,req:"remove-friend"});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=Object(u.a)(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/leave-room"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({room_id:t.room_id})});case 2:return n=e.sent,window.location.reload(),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:z.push("/room/"+t.room_id);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(u.a)(i.a.mark((function e(n){var r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("event target: ",n.target),console.log("event target value: ",n.target.id),e.next=4,fetch("https://".concat("rtc-server.one","/api/add-to-room"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({friend_id:n.target.id,room_id:t.room_id})});case 4:return r=e.sent,e.next=7,r.json();case 7:c=e.sent,console.log(c),"Friend is already in room"!==c.message&&t.setReq({sender_id:t.user._id,friend_id:n.target.id,room_id:t.room_id,req:"add-to-room"});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{className:"friend-container mt-2",id:t.id,children:[Object(p.jsx)("img",{src:"../"+v,alt:"friend",className:"".concat(n),id:t.id}),t.overlay?t.isRoom?Object(p.jsx)("div",{className:"overlay ".concat(n),children:Object(p.jsxs)("div",{className:"col",children:[Object(p.jsx)(m.a,{style:{margin:"0 auto",display:"flex"},className:"overlay-btn mt-3",variant:"contained",color:"secondary",size:"small",onClick:E,children:"Chat"}),Object(p.jsx)(m.a,{style:{margin:"0 auto",display:"flex"},variant:"contained",color:"secondary",className:"overlay-btn mt-2",id:"basic-button","aria-controls":"basic-menu","aria-haspopup":"true","aria-expanded":J?"true":void 0,onClick:function(e){I(e.currentTarget)},children:"Invite Friend"}),Object(p.jsx)(f.a,{id:"basic-menu",anchorEl:q,open:J,onClose:function(){I(null)},MenuListProps:{"aria-labelledby":"basic-button"},children:Object.keys(k).map((function(t){return Object(p.jsx)(b.a,{sx:{backgroundColor:"#242424","&:hover":{backgroundColor:"#2d2d2d"}},onClick:function(e){return L(e)},children:Object(p.jsx)(e,{alt:"friend",size:"img-small",isRoom:!1,friend_id:k[t],id:k[t]})},t)}))}),Object(p.jsx)(m.a,{style:{margin:"0 auto",display:"flex"},variant:"contained",color:"error",className:"overlay-btn mt-2",onClick:D,children:"Leave Room"})]})}):"img-large"===n?Object(p.jsx)("div",{className:"overlay ".concat(n),children:Object(p.jsxs)("div",{className:"col",children:[!1===o?Object(p.jsx)(m.a,{style:{margin:"0 auto",display:"flex"},className:"overlay-btn mt-4",variant:"contained",color:"secondary",size:"small",onClick:F,children:"Add Friend"}):Object(p.jsx)(m.a,{style:{margin:"0 auto",display:"flex"},className:"overlay-btn mt-4",variant:"contained",color:"secondary",size:"small",onClick:function(){z.push("/friend/"+t.friend_id)},children:"Message"}),!0===o?Object(p.jsx)(m.a,{style:{margin:"0 auto",display:"flex"},className:"overlay-btn mt-4",variant:"contained",color:"error",size:"small",onClick:U,children:"Remove Friend"}):null]})}):null:null," "]}),Object(p.jsx)("div",{className:"friend-name",children:Object(p.jsx)("p",{children:S})})]})},x=(n(100),function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],s=n[1],a=Object(r.useState)([]),o=Object(l.a)(a,2),m=o[0],f=o[1],b=Object(d.f)(),h=function(){return s(!c)};Object(r.useEffect)((function(){var t=function(){var t=Object(u.a)(i.a.mark((function t(){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://".concat("rtc-server.one","/api/get-room-info"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({room_id:e.room_id})});case 2:return n=t.sent,t.next=5,n.json();case 5:r=t.sent,console.log(r.users),f(r.users);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();null===e.room_id?f([]):t()}),[e.room_id]);var x,v=function(){var t=Object(u.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setUser(""),t.next=3,fetch("https://".concat("rtc-server.one","/api/logout"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});case 3:localStorage.removeItem("user"),b.push("/login");case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return x=""===e.user?Object(p.jsx)(p.Fragment,{}):Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("div",{className:"navbar",children:[Object(p.jsx)("div",{className:"container-fluid navbar-container"}),Object(p.jsx)("div",{className:"nav-bars",children:Object(p.jsx)("i",{className:"fas fa-bars fa-3x",onClick:h})}),Object(p.jsx)("nav",{className:c?"nav-menu active":"nav-menu",children:Object(p.jsxs)("ul",{className:"nav-menu-items",onClick:h,children:[Object(p.jsx)("li",{className:"nav-toggle",children:Object(p.jsx)("div",{className:"nav-x",children:Object(p.jsx)("i",{className:"fas fa-times fa-3x"})})}),Object(p.jsx)("li",{className:"nav-text",children:Object(p.jsxs)(j.b,{to:"/",children:[Object(p.jsx)("i",{className:"fas fa-atom"}),Object(p.jsx)("span",{children:" Home"})]})}),Object(p.jsx)("li",{className:"nav-text",children:Object(p.jsxs)(j.b,{to:"/login",onClick:v,children:[Object(p.jsx)("i",{className:"fas fa-power-off"}),Object(p.jsx)("span",{children:" Logout"})]})}),0===m.length?null:Object.keys(m).map((function(e){return Object(p.jsx)("li",{className:"",children:Object(p.jsx)(O,{alt:"default.jpeg",size:"img-small",isRoom:!1,friend_id:m[e]})},e)}))]})})]})}),Object(p.jsx)(p.Fragment,{children:x})}),v=n(17),g=n(72),y=n.n(g),N=(n(101),["btn--primary","btn--secondary","btn--outline"]),S=["btn--med","btn--lg","btn--sm"],w=function(e){var t=e.children,n=e.type,r=e.onClick,c=e.buttonStyle,s=e.buttonSize,a=e.my,o=e.mx,i=e.classes,u=N.includes(c)?c:N[0],l=S.includes(s)?s:S[0];return Object(p.jsx)("button",{className:"btn ".concat(l," ").concat(u," ").concat(a," ").concat(o," ").concat(i),onClick:r,type:n,children:t})},_=n(159),C=(n(102),n(53),function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),c=n[0],s=n[1],a=Object(r.useState)(""),o=Object(l.a)(a,2),d=o[0],j=o[1],m=Object(r.useState)(!1),f=Object(l.a)(m,2),b=f[0],h=f[1],x=Object(r.useState)(""),v=Object(l.a)(x,2),g=v[0],y=v[1],N=function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("https://".concat("rtc-server.one","/api/search-friend"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:d})});case 3:return n=e.sent,e.next=6,n.json();case 6:null!==(r=e.sent)?(s(""),h(!0),y(r)):(s("user not found"),h(!1),y(""));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)("div",{className:e.search?"search-window active":"search-window",children:Object(p.jsx)("div",{className:"search-box",children:Object(p.jsxs)("div",{className:"mt-5",align:"center",children:[Object(p.jsx)(_.a,{label:"Search...",maxRows:4,variant:"filled",onChange:function(e){return j(e.target.value)}}),Object(p.jsx)(w,{buttonSize:"btn--md",buttonStyle:"btn--secondary",type:"submit",my:"mt-2",mx:"mx-auto",onClick:N,children:"Search"}),""===c?null:Object(p.jsx)("li",{className:"search-result",children:c}),b?Object.keys(g).map((function(t){return Object(p.jsx)("li",{className:"search-result",children:Object(p.jsx)(O,{src:g[t].profile_pic,alt:"friend",size:"img-large",name:g[t].username,friend_id:g[t]._id,setReq:function(t){return e.setReq(t)},user:e.user,inPending:!1,overlay:!0})},t)})):null]})})})}),k=(n(103),function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2),c=n[0],s=n[1],a=Object(r.useState)(""),o=Object(l.a)(a,2),d=o[0],j=o[1],m=function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("https://".concat("rtc-server.one","/api/create-room"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:d})});case 3:return n=e.sent,e.next=6,n.json();case 6:"Successfully created room!"===(r=e.sent).message?window.location.reload():s(r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)("div",{className:e.createRoom?"create-window active":"create-window",children:Object(p.jsx)("div",{className:"search-box",children:Object(p.jsxs)("div",{className:"mt-5",align:"center",children:[Object(p.jsx)(_.a,{label:"Room Name",variant:"filled",onChange:function(e){return j(e.target.value)}}),Object(p.jsx)(w,{buttonSize:"btn--md",buttonStyle:"btn--secondary",type:"submit",my:"mt-2",mx:"mx-auto",onClick:m,children:"Create Room"}),""===c?null:Object(p.jsx)("li",{className:"search-result",children:c})]})})})}),R=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)(!1),c=Object(l.a)(n,2),s=c[0],a=c[1],o=Object(r.useState)(!1),j=Object(l.a)(o,2),m=j[0],f=j[1],b=Object(r.useState)(""),h=Object(l.a)(b,2),x=h[0],g=h[1],N=Object(r.useState)([]),S=Object(l.a)(N,2),w=S[0],_=S[1],R=Object(r.useState)(""),T=Object(l.a)(R,2),P=T[0],q=T[1],I=Object(r.useRef)();I.current=P;var J=y()(null,(function(e){null!==e&&1===t.current.readyState&&(t.current.send(JSON.stringify(e)),F(null))})),z=Object(l.a)(J,2),F=(z[0],z[1]),U=Object(d.f)();e.setRoomID(null),localStorage.getItem("user")||U.push("/login");var D=s?"rotate-icon":"",E=m?"rotate-icon":"";return console.log("requests in home: ",P),Object(r.useEffect)((function(){var n=!0,r=function(){var e=Object(u.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/get-friends"),{headers:{"Content-Type":"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,n&&g(r.friends);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=Object(u.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/get-friend-reqs"),{headers:{"Content-Type":"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,n&&q(r.requests);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(u.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/get-rooms"),{headers:{"Content-Type":"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:r=e.sent,n&&_(r.rooms);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n&&(r().catch(g("")),c().catch(q("")),s().catch(_([]))),t.current=new WebSocket("wss://".concat("rtc-server.one","/ws")),t.current.onopen=function(e){console.log("Connected to ws")},t.current.onmessage=function(t){var n=JSON.parse(t.data);switch(console.log("requests: ",P),n.req){case"add-friend":console.log("requests: ",I.current);var r=[],c=!1;Object.keys(I.current).map((function(e){return I.current[e]!==n.friend_id?r.push(P[e]):c=!0,I.current[e]})),console.log("isInRequests: ",c),n.sender_id===e.user._id?c&&(console.log("Accepting friend request"),console.log("new requests: ",r),q(r),g((function(e){return[].concat(Object(v.a)(e),[n.friend_id])}))):"true"===n.in_pending?(console.log("Friend accepted request"),g((function(e){return[].concat(Object(v.a)(e),[n.friend_id])}))):(console.log("Received friend request"),q((function(e){return[].concat(Object(v.a)(e),[n.friend_id])})));break;case"remove-friend":var s=[];Object.keys(x).map((function(e){return console.log("friend: ",x[e]),x[e]!==n.friend_id&&s.push(x[e]),x[e]})),console.log("filtered array: ",s),g(s);break;case"add-to-room":console.log("In add-to-room"),console.log("Is receiver: ",n.sender_id!==e.user._id),n.sender_id!==e.user._id&&window.location.reload();break;default:F(null)}},t.current.onclose=function(e){console.log("socket closed connection: ",e)},function(){n=!1}}),[]),Object(p.jsxs)("div",{className:"container",children:[Object(p.jsxs)("div",{className:"rooms-header",children:[Object(p.jsx)("h2",{className:"rooms-header-text mb-0",children:"Friends"}),Object(p.jsx)("i",{className:"fas fa-plus-circle add-btn mb-0 ".concat(D),onClick:function(){return a(!s)}})]}),Object(p.jsx)("div",{className:"search-window-container",children:Object(p.jsx)(C,{search:s,setSearch:a,setReq:function(e){F(e)},user:e.user})}),Object(p.jsx)("div",{className:"row",children:null===x?null:Object.keys(x).map((function(t){return Object(p.jsx)("div",{className:"col-sm-12 col-md-4 col-lg-2 px-0 mx-3",children:Object(p.jsx)(O,{alt:"friend",size:"img-large",isRoom:!1,friend_id:x[t],setReq:function(e){F(e)},user:e.user,inPending:!1,overlay:!0})},t)}))}),Object(p.jsxs)("div",{className:"rooms-header",children:[Object(p.jsx)("h2",{className:"rooms-header-text mt-2",children:"Rooms"}),Object(p.jsx)("i",{className:"fas fa-plus-circle add-btn mb-0 ".concat(E),onClick:function(){return f(!m)}})]}),Object(p.jsx)("div",{className:"search-window-container",children:Object(p.jsx)(k,{createRoom:m})}),Object(p.jsx)("div",{className:"row",children:null===w?null:Object.keys(w).map((function(t){return Object(p.jsx)("div",{className:"col-sm-12 col-md-4 col-lg-2 px-0 mx-3",children:Object(p.jsx)(O,{alt:"default_room.jpeg",size:"img-large",isRoom:!0,room_id:w[t],setReq:function(e){F(e)},user:e.user,overlay:!0})},t)}))}),Object(p.jsx)("div",{className:"rooms-header",children:Object(p.jsx)("h2",{className:"rooms-header-text mb-0",children:"Pending Friends"})}),Object(p.jsx)("div",{className:"row",children:null===P?null:Object.keys(P).map((function(t){return Object(p.jsx)("div",{className:"col-sm-12 col-md-4 col-lg-2 px-0 mx-3",children:Object(p.jsx)(O,{src:"default_pic.jpeg",alt:"friend",size:"img-large",name:"username",isRoom:!1,friend_id:P[t],setReq:function(e){F(e)},user:e.user,inPending:!0,overlay:!0})},t)}))}),Object(p.jsx)("p",{className:"mt-5 mb-3 mx-auto text-muted",children:"\xa9 2017\u20132021"})]})},T=(n(66),function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),c=n[0],s=n[1],a=Object(r.useState)(""),o=Object(l.a)(a,2),m=o[0],f=o[1],b=Object(r.useState)(""),h=Object(l.a)(b,2),O=h[0],x=h[1],v=Object(r.useState)(""),g=Object(l.a)(v,2),y=g[0],N=g[1],S=Object(d.f)();localStorage.getItem("user")&&S.push("/");var _=function(){var t=Object(u.a)(i.a.mark((function t(n){var r,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),t.next=3,fetch("https://".concat("rtc-server.one","/api/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:m,password:O})});case 3:return r=t.sent,t.next=6,r.json();case 6:c=t.sent,console.log("Login",c),void 0!==c.message?N(c.message):(localStorage.setItem("user",c),e.setUser(c),N(""),s(!0));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return c?Object(p.jsx)(d.a,{to:"/"}):Object(p.jsxs)("form",{className:"container login-form",onSubmit:_,children:[Object(p.jsx)("h2",{className:"signin-header",children:"Please Sign In"}),Object(p.jsx)("div",{className:"login-input",children:Object(p.jsx)("input",{type:"email",className:"form-control",placeholder:"Email Address",required:!0,onChange:function(e){return f(e.target.value)}})}),Object(p.jsx)("div",{className:"login-input mb-4",children:Object(p.jsx)("input",{type:"password",className:"form-control",placeholder:"Password",required:!0,onChange:function(e){return x(e.target.value)}})}),Object(p.jsx)("div",{className:"text-danger mb-3",children:y}),Object(p.jsx)(w,{buttonStyle:"btn--primary",type:"submit",children:"Sign In"}),Object(p.jsxs)("p",{className:"mt-5 mb-3 text-muted",children:["Need and account? ",Object(p.jsx)(j.b,{to:"register",children:"Register"})]})]})}),P=function(e){var t=Object(r.useState)(""),n=Object(l.a)(t,2)[1],c=Object(r.useState)(!1),s=Object(l.a)(c,2),a=s[0],o=s[1],m=Object(r.useState)(""),f=Object(l.a)(m,2),b=f[0],h=f[1],O=Object(r.useState)(""),x=Object(l.a)(O,2),v=x[0],g=x[1],y=Object(r.useState)(""),N=Object(l.a)(y,2),S=N[0],_=N[1],C=Object(r.useState)(""),k=Object(l.a)(C,2),R=k[0],T=k[1],P=Object(d.f)();localStorage.getItem("user")&&P.push("/"),console.log(e.username);var q=function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),S){e.next=5;break}return e.next=4,fetch("https://".concat("rtc-server.one","/api/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:b,email:v,password:R})});case 4:o(!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(a)return Object(p.jsx)(d.a,{to:"/login"});return Object(p.jsxs)("form",{className:"container login-form",onSubmit:q,children:[Object(p.jsx)("h2",{className:"signin-header",children:"Sign Up"}),Object(p.jsx)("div",{className:"login-input",children:Object(p.jsx)("input",{type:"text",className:"form-control",name:"username",placeholder:"Username",required:!0,onChange:function(e){return h(e.target.value)}})}),Object(p.jsx)("div",{className:"login-input",children:Object(p.jsx)("input",{type:"email",className:"form-control",name:"email",placeholder:"Email Address",required:!0,onChange:function(e){return g(e.target.value)}})}),Object(p.jsx)("div",{className:"login-input",children:Object(p.jsx)("input",{type:"password",className:"form-control",name:"pass",placeholder:"Password",required:!0,onChange:function(e){return T(e.target.value)}})}),Object(p.jsx)("div",{className:"login-input",children:Object(p.jsx)("input",{type:"password",className:"form-control",name:"confirmPass",placeholder:"Confirm Password",required:!0,onChange:function(e){return function(e){var t=e;n(t),_(R!==t?"Passwords do not match":"")}(e.target.value)}})}),Object(p.jsx)("div",{className:"text-danger mb-3",children:S}),Object(p.jsx)(w,{buttonStyle:"btn--primary",link:"/register",type:"submit",children:"Sign Up"}),Object(p.jsxs)("p",{className:"mt-5 mb-3 text-muted",children:["Have an account? ",Object(p.jsx)(j.b,{to:"/login",children:"Login"})]})]})},q=function(e){var t=e.isCurrUser?"current-user":"not-current-user";return Object(p.jsxs)("div",{className:"message mt-3 ".concat(t),children:[Object(p.jsx)("div",{className:"message-text mx-2 mt-2",children:e.user+":"}),Object(p.jsx)("div",{className:"message-text mx-2 mt-2",children:e.text})]})},I=(n(104),function(e){return Object(p.jsxs)("div",{className:"row mt-5 message-box",align:"center",children:[Object(p.jsx)("div",{className:"col-sm-11 px-0",children:Object(p.jsx)(_.a,{id:"filled-multiline-flexible",className:"message-input",label:"Message",fullWidth:!0,variant:"filled",onChange:function(t){return e.onChange(t.target.value)}})}),Object(p.jsx)("div",{className:"col-sm-1 my-auto pl-1",children:Object(p.jsx)(w,{buttonSize:"btn--md btn--primary",onClick:e.onClick,children:"Send"})})]})}),J=(n(67),function(e){var t=Object(r.useRef)(null),n=Object(d.f)(),c=Object(r.useState)(),s=Object(l.a)(c,2),a=s[0],o=s[1],j=Object(r.useState)([]),m=Object(l.a)(j,2),f=m[0],b=m[1],h=Object(r.useState)(""),x=Object(l.a)(h,2),g=x[0],y=x[1];e.setRoomID(null);var N=Object(d.g)().friend_id;localStorage.getItem("user")||n.push("/login"),Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/get-friend-chat"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({friend_id:N})});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,y(n.room_id);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/get-messages"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({room_id:g})});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,b(n.messages);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),n(),t.current=new WebSocket("wss://".concat("rtc-server.one","/ws/")+g),t.current.onopen=function(e){console.log("Connection at: ",g)},t.current.onmessage=function(e){var t=JSON.parse(e.data);console.log(t),b((function(e){return[].concat(Object(v.a)(e),[t])}))},t.current.onclose=function(e){console.log("socket closed connection: ",e)}}),[N,g]);return Object(p.jsxs)("div",{className:"container room-friend-container",children:[Object(p.jsx)("div",{className:"row mt-5",children:Object(p.jsx)(O,{alt:"friend",size:"img-large",isRoom:!1,friend_id:N,overlay:!1})}),Object(p.jsx)("div",{className:"row",children:0===f.length?null:Object.keys(f).map((function(t){return Object(p.jsx)("div",{className:"",children:Object(p.jsx)(q,{user:f[t].user,text:f[t].text,isCurrUser:e.user.username===f[t].user})},t)}))}),Object(p.jsx)("div",{className:"row",children:Object(p.jsx)(I,{onChange:o,onClick:function(){t.current.send(a)}})})]})}),z=function(e){var t=Object(r.useRef)(null),n=Object(d.f)(),c=Object(r.useState)(),s=Object(l.a)(c,2),a=s[0],o=s[1],j=Object(r.useState)(""),m=Object(l.a)(j,2),f=m[0],b=m[1],h=Object(d.g)().room_id;e.setRoomID(h),localStorage.getItem("user")||n.push("/login"),Object(r.useEffect)((function(){(function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/get-messages"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({room_id:h})});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,b(n.messages);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),t.current=new WebSocket("ws://".concat("rtc-server.one","/ws/")+h),t.current.onopen=function(e){console.log("Connection at: ",h)},t.current.onmessage=function(e){var t=JSON.parse(e.data);console.log(t),b((function(e){return[].concat(Object(v.a)(e),[t])}))},t.current.onclose=function(e){console.log("socket closed connection: ",e)}}),[h]);return Object(p.jsxs)("div",{className:"container room-friend-container",children:[Object(p.jsx)("div",{className:"row mt-5",children:Object(p.jsx)(O,{alt:"room",size:"img-large",isRoom:!0,room_id:h,overlay:!1})}),Object(p.jsx)("div",{className:"row",children:0===f.length?null:Object.keys(f).map((function(t){return Object(p.jsx)("div",{className:"",children:Object(p.jsx)(q,{user:f[t].user,text:f[t].text,isCurrUser:e.user.username===f[t].user})},t)}))}),Object(p.jsx)("div",{className:"row",children:Object(p.jsx)(I,{onChange:o,onClick:function(){return t.current.send(a)}})})]})};var F=function(){var e=Object(r.useState)(""),t=Object(l.a)(e,2),n=t[0],c=t[1],s=Object(r.useState)(null),a=Object(l.a)(s,2),o=a[0],m=a[1];return Object(r.useEffect)((function(){(function(){var e=Object(u.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://".concat("rtc-server.one","/api/getuser"),{headers:{"Content-Type":"application/json"},credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:void 0!==(n=e.sent).message?c(""):(localStorage.setItem("user",n),c(n));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().catch(c(""))}),[]),Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)(j.a,{children:[Object(p.jsx)(x,{user:n,setUser:c,room_id:o}),Object(p.jsx)(d.b,{exact:!0,path:"/",component:function(){return Object(p.jsx)(R,{user:n,setUser:c,setRoomID:function(e){return m(e)}})}}),Object(p.jsx)(d.b,{path:"/login",component:function(){return Object(p.jsx)(T,{user:n,setUser:c})}}),Object(p.jsx)(d.b,{path:"/register",component:function(){return Object(p.jsx)(P,{user:n})}}),Object(p.jsx)(d.b,{exact:!0,path:"/friend/:friend_id",component:function(){return Object(p.jsx)(J,{user:n,isRoom:!1,setRoomID:function(e){return m(e)}})}}),Object(p.jsx)(d.b,{exact:!0,path:"/room/:room_id",component:function(){return Object(p.jsx)(z,{user:n,isRoom:!0,setRoomID:function(e){return m(e)}})}})]})})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,166)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),s(e),a(e)}))};a.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(F,{})}),document.getElementById("root")),U()},53:function(e,t,n){},64:function(e,t,n){},66:function(e,t,n){},67:function(e,t,n){},86:function(e,t,n){},88:function(e,t,n){},89:function(e,t,n){}},[[105,1,2]]]);
//# sourceMappingURL=main.aa4a10ec.chunk.js.map